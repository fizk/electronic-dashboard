name: Deploy
on: [push]

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            -
                name: Check out repository code
                uses: actions/checkout@v4
            -
                name: Install dependencies
                run: npm i
            -
                name: Builds Server code
                run: npm run build-server
            -
                name: Builds Client code
                run: npm run build-client
    deploy:
        runs-on: ubuntu-latest
        needs: build
        steps:
            -
                name: copy file via ssh key
                uses: appleboy/scp-action@v0.1.7
                with:
                    host: ${{ secrets.HOST }}
                    username: ${{ secrets.USERNAME }}
                    port: ${{ secrets.PORT }}
                    key: ${{ secrets.KEY }}
                    source: "server, client"
                    target: /var/www/electronics